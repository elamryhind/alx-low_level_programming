more functions,more nesdted loops
